groups:
  - name: tablet.rules
    interval: 1m
    rules:
      - alert: TabletHighQPS
        expr: sum by (instance) (increase(vttablet_query_counts[1m])) > 1
        for: 1m
        labels:
          severity: warning
        annotations:
          summary: "High QPS on {{ $labels.instance }}"

      - alert: TabletHighErrorRate
        expr: (
          sum by (instance) (rate(vttablet_query_error_counts[5m]))
          /
          sum by (instance) (rate(vttablet_query_counts[5m]))) * 100 > 0.5
        for: 1m
        labels:
          severity: warning
        annotations:
          summary: "High error rate on {{ $labels.instance }}"

      - alert: TabletHighProcessCPU
        expr: rate(process_cpu_seconds_total{job="vttablets"}[1m]) > 0.1
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: "High process CPU on {{ $labels.instance }}"
