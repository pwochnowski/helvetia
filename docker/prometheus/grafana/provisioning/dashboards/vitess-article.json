{
  "annotations": { "list": [] },
  "editable": true,
  "graphTooltip": 1,
  "id": null,
  "links": [{ "asDropdown": true, "icon": "external link", "includeVars": false, "keepTime": true, "tags": ["vitess"], "targetBlank": false, "title": "Other Keyspaces", "type": "dashboards" }],
  "templating": {
    "list": [
      { "current": { "text": "article", "value": "article" }, "hide": 2, "name": "keyspace", "options": [{ "selected": true, "text": "article", "value": "article" }], "query": "article", "type": "constant" },
      { "current": { "selected": true, "text": "All", "value": "$__all" }, "datasource": { "type": "prometheus", "uid": "prometheus" }, "definition": "label_values(vttablet_queries_count{keyspace=\"$keyspace\"}, role)", "hide": 0, "includeAll": true, "label": "Role", "multi": true, "name": "role", "query": { "query": "label_values(vttablet_queries_count{keyspace=\"$keyspace\"}, role)" }, "refresh": 1, "sort": 1, "type": "query" },
      { "current": { "selected": true, "text": "All", "value": "$__all" }, "datasource": { "type": "prometheus", "uid": "prometheus" }, "definition": "label_values(vttablet_queries_count{keyspace=\"$keyspace\"}, shard)", "hide": 0, "includeAll": true, "label": "Shard", "multi": true, "name": "shard", "query": { "query": "label_values(vttablet_queries_count{keyspace=\"$keyspace\"}, shard)" }, "refresh": 1, "sort": 1, "type": "query" },
      { "current": { "selected": true, "text": "All", "value": "$__all" }, "hide": 0, "includeAll": true, "label": "Query Type", "multi": true, "name": "query_type", "options": [{ "selected": true, "text": "All", "value": "$__all" }, { "text": "SELECT", "value": "Select" }, { "text": "INSERT", "value": "Insert" }, { "text": "UPDATE", "value": "Update" }, { "text": "DELETE", "value": "DeleteLimit" }], "query": "Select,Insert,Update,DeleteLimit", "type": "custom" }
    ]
  },
  "panels": [
    { "datasource": { "type": "prometheus", "uid": "prometheus" }, "fieldConfig": { "defaults": { "color": { "mode": "palette-classic" }, "custom": { "drawStyle": "line", "fillOpacity": 20, "lineWidth": 2, "showPoints": "never", "stacking": { "mode": "none" } }, "unit": "ops" } }, "gridPos": { "h": 8, "w": 24, "x": 0, "y": 0 }, "id": 1, "options": { "legend": { "calcs": ["mean", "last"], "displayMode": "table", "placement": "right" }, "tooltip": { "mode": "multi", "sort": "desc" } }, "targets": [{ "expr": "sum by (shard, role) (rate(vttablet_queries_count{keyspace=\"$keyspace\", role=~\"$role\", shard=~\"$shard\", plan_type=~\"$query_type\"}[30s]))", "legendFormat": "{{shard}} ({{role}})" }], "title": "Total QPS by Shard", "type": "timeseries" },
    { "datasource": { "type": "prometheus", "uid": "prometheus" }, "fieldConfig": { "defaults": { "color": { "mode": "palette-classic" }, "custom": { "drawStyle": "line", "fillOpacity": 20, "lineWidth": 2, "showPoints": "never", "stacking": { "mode": "none" } }, "unit": "ops" } }, "gridPos": { "h": 8, "w": 24, "x": 0, "y": 8 }, "id": 2, "options": { "legend": { "calcs": ["mean", "last"], "displayMode": "table", "placement": "right" }, "tooltip": { "mode": "multi", "sort": "desc" } }, "targets": [{ "expr": "sum by (shard, role) (rate(vttablet_queries_count{keyspace=\"$keyspace\", role=~\"$role\", shard=~\"$shard\", plan_type=\"Select\"}[30s]))", "legendFormat": "{{shard}} ({{role}})" }], "title": "SELECT QPS", "type": "timeseries" },
    { "datasource": { "type": "prometheus", "uid": "prometheus" }, "fieldConfig": { "defaults": { "color": { "mode": "palette-classic" }, "custom": { "drawStyle": "bars", "fillOpacity": 80, "lineWidth": 1, "showPoints": "never", "stacking": { "mode": "normal" } }, "unit": "ops" } }, "gridPos": { "h": 8, "w": 24, "x": 0, "y": 16 }, "id": 3, "options": { "legend": { "calcs": ["mean", "last"], "displayMode": "table", "placement": "right" }, "tooltip": { "mode": "multi", "sort": "desc" } }, "targets": [{ "expr": "sum by (plan_type) (rate(vttablet_queries_count{keyspace=\"$keyspace\", role=~\"$role\", shard=~\"$shard\", plan_type=~\"$query_type\"}[30s]))", "legendFormat": "{{plan_type}}" }], "title": "QPS by Query Type", "type": "timeseries" },
    { "datasource": { "type": "prometheus", "uid": "prometheus" }, "fieldConfig": { "defaults": { "color": { "mode": "thresholds" }, "thresholds": { "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 10 }, { "color": "red", "value": 50 }] }, "unit": "ops" } }, "gridPos": { "h": 5, "w": 24, "x": 0, "y": 24 }, "id": 4, "options": { "colorMode": "background", "graphMode": "none", "orientation": "vertical", "reduceOptions": { "calcs": ["lastNotNull"] }, "textMode": "value_and_name" }, "targets": [{ "expr": "sum by (shard, role) (rate(vttablet_queries_count{keyspace=\"$keyspace\", role=~\"$role\", shard=~\"$shard\", plan_type=~\"$query_type\"}[30s]))", "instant": true, "legendFormat": "{{shard}} ({{role}})" }], "title": "Current QPS per Shard", "type": "stat" }
  ],
  "refresh": "5s",
  "schemaVersion": 38,
  "tags": ["vitess", "article"],
  "time": { "from": "now-15m", "to": "now" },
  "title": "Vitess: article",
  "uid": "vitess-article",
  "version": 1
}
